const pool=require("../db"),getProfessionalProfile=async(req,res)=>{const userProfile=req.user;userProfile?res.status(200).json(userProfile):res.status(404).json({error:"Usuario no encontrado."})},updateProfessionalProfile=async(req,res)=>{const userId=req.user.id,{nombre_completo:nombre_completo,email:email,especialidad:especialidad}=req.body;try{const updateQuery="\n        UPDATE Profesionales\n        SET \n          nombre_completo = COALESCE($1, nombre_completo),\n          email = COALESCE($2, email),\n          especialidad = COALESCE($3, especialidad)\n        WHERE id = $4\n        RETURNING id, nombre_completo, email, especialidad;\n      ",updatedUser=await pool.query(updateQuery,[nombre_completo,email,especialidad,userId]);res.status(200).json(updatedUser.rows[0])}catch(err){if("23505"===err.code)return res.status(409).json({error:"El correo electrónico ya está en uso."});console.error("❌ Error al actualizar el perfil:",err),res.status(500).json({error:"Error interno del servidor."})}};module.exports={getProfessionalProfile:getProfessionalProfile,updateProfessionalProfile:updateProfessionalProfile};